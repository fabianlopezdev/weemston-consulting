---
import BaseLayout from '@layouts/BaseLayout.astro';
import { sanityClient as client } from 'sanity:client';
import { servicesPageNewQuery } from '@lib/sanity/queries';
import ServicesHero from '@components/sections/ServicesHero.astro';
import ServiceSection from '@components/sections/ServiceSection.astro';

const page = await client.fetch(servicesPageNewQuery);

if (!page) {
  return Astro.redirect('/404');
}
---

<BaseLayout title={page.title} description={page.metaDescription}>
  {/* Hero Section */}
  <ServicesHero
    heading={page.heroHeading}
    headingHighlight={page.heroHeadingHighlight}
    highlightColorType={page.heroHighlightColorType}
    highlightColorShade={page.heroHighlightColorShade}
    highlightCustomColor={page.heroHighlightCustomColor}
    showDivider={page.heroShowDivider}
    dividerColorType={page.heroDividerColorType}
    dividerColorShade={page.heroDividerColorShade}
    dividerCustomColor={page.heroDividerCustomColor}
    tagline={page.heroTagline}
    taglineColor={page.heroTaglineColor}
    backgroundColorType={page.heroBackgroundColorType}
    backgroundColorShade={page.heroBackgroundColorShade}
    backgroundCustomColor={page.heroBackgroundCustomColor}
  />

  {/* Service Sections */}
  {
    page.services &&
      page.services.length > 0 &&
      page.services.map((service: any) => (
        <ServiceSection
          tag={service.tag}
          title={service.title}
          leadText={service.leadText}
          description={service.description}
          listStyle={service.listStyle}
          listTitle={service.listTitle}
          listItems={service.listItems}
          caseStudiesLinkText={service.caseStudiesLinkText}
          caseStudiesLink={service.caseStudiesLink}
          icon={service.icon}
          imagePosition={service.imagePosition}
          backgroundColor={service.backgroundColor}
        />
      ))
  }
</BaseLayout>
