---
import BaseLayout from '@layouts/BaseLayout.astro';
import { sanityClient as client } from 'sanity:client';
import { servicesPageNewQuery } from '@lib/sanity/queries';
import InternalPageHero from '@components/sections/InternalPageHero.astro';
import ServiceSection from '@components/sections/ServiceSection.astro';

const page = await client.fetch(servicesPageNewQuery);

if (!page) {
  return Astro.redirect('/404');
}
---

<BaseLayout title={page.title} description={page.metaDescription}>
  {/* Hero Section */}
  <InternalPageHero
    heading={page.heroHeading}
    headingHighlight={page.heroHeadingHighlight}
    highlightColorType={page.heroHighlightColorType}
    highlightColorShade={page.heroHighlightColorShade}
    highlightCustomColor={page.heroHighlightCustomColor}
    showDivider={page.heroShowDivider}
    dividerColorType={page.heroDividerColorType}
    dividerColorShade={page.heroDividerColorShade}
    dividerCustomColor={page.heroDividerCustomColor}
    tagline={page.heroTagline}
    taglineColor={page.heroTaglineColor}
    backgroundColorType={page.heroBackgroundColorType}
    backgroundColorMode={page.heroBackgroundColorMode}
    backgroundColorShade={page.heroBackgroundColorShade}
    backgroundCustomColor={page.heroBackgroundCustomColor}
    backgroundGradient={page.heroBackgroundGradient}
  />

  {/* Service Sections */}
  {
    page.services &&
      page.services.length > 0 &&
      page.services.map((service: any, index: number) => (
        <ServiceSection
          serviceIndex={index}
          title={service.title}
          leadText={service.leadText}
          description={service.description}
          iconType={service.iconType}
          icon={service.icon}
          iconImage={service.iconImage}
          imagePosition={service.imagePosition}
          backgroundColorType={service.backgroundColorType}
          backgroundColorMode={service.backgroundColorMode}
          backgroundColorShade={service.backgroundColorShade}
          backgroundCustomColor={service.backgroundCustomColor}
          backgroundGradient={service.backgroundGradient}
          titleColorType={service.titleColorType}
          titleColorShade={service.titleColorShade}
          titleCustomColor={service.titleCustomColor}
          leadTextColor={service.leadTextColor}
          descriptionTextColor={service.descriptionTextColor}
          iconColorType={service.iconColorType}
          iconColorShade={service.iconColorShade}
          iconCustomColor={service.iconCustomColor}
          iconContainerColorType={service.iconContainerColorType}
          iconContainerColorShade={service.iconContainerColorShade}
          iconContainerCustomColor={service.iconContainerCustomColor}
          listStyle={service.listStyle}
          listTitle={service.listTitle}
          listItems={service.listItems}
          listTextColor={service.listTextColor}
          listContainerColorType={service.listContainerColorType}
          listContainerColorShade={service.listContainerColorShade}
          listContainerCustomColor={service.listContainerCustomColor}
          listIconColorType={service.listIconColorType}
          listIconColorShade={service.listIconColorShade}
          listIconCustomColor={service.listIconCustomColor}
          caseStudiesSectionTitle={service.caseStudiesSectionTitle}
          caseStudiesTitleColorType={service.caseStudiesTitleColorType}
          caseStudiesTitleColorShade={service.caseStudiesTitleColorShade}
          caseStudiesTitleCustomColor={service.caseStudiesTitleCustomColor}
          logoDisplayMode={service.logoDisplayMode}
          featuredCaseStudies={service.featuredCaseStudies}
        />
      ))
  }
</BaseLayout>
