---
import BaseLayout from '@layouts/BaseLayout.astro';
import { sanityClient as client } from 'sanity:client';
import { aboutPageQuery } from '@lib/sanity/queries';
import InternalPageHero from '@components/sections/InternalPageHero.astro';
import AboutBio from '@components/sections/AboutBio.astro';
import AboutGlobal from '@components/sections/AboutGlobal.astro';
import AboutTrustedBy from '@components/sections/AboutTrustedBy.astro';

const page = await client.fetch(aboutPageQuery);

if (!page) {
  return Astro.redirect('/404');
}
---

<BaseLayout title={page.title} description={page.metaDescription}>
  {/* Hero Section */}
  <InternalPageHero
    heading={page.heroHeading}
    headingHighlight={page.heroHeadingHighlight}
    highlightColorType={page.heroHighlightColorType}
    highlightColorShade={page.heroHighlightColorShade}
    highlightCustomColor={page.heroHighlightCustomColor}
    showDivider={page.heroShowDivider}
    dividerColorType={page.heroDividerColorType}
    dividerColorShade={page.heroDividerColorShade}
    dividerCustomColor={page.heroDividerCustomColor}
    tagline={page.heroTagline}
    taglineColor={page.heroTaglineColor}
    backgroundColorType={page.heroBackgroundColorType}
    backgroundColorMode={page.heroBackgroundColorMode}
    backgroundColorShade={page.heroBackgroundColorShade}
    backgroundCustomColor={page.heroBackgroundCustomColor}
    backgroundGradient={page.heroBackgroundGradient}
  />

  {/* Bio Section */}
  {
    (page.bioName || page.bioImage) && (
      <AboutBio
        image={page.bioImage}
        label={page.bioLabel}
        labelColorType={page.bioLabelColorType}
        labelColorShade={page.bioLabelColorShade}
        labelCustomColor={page.bioLabelCustomColor}
        name={page.bioName}
        nameColorType={page.bioNameColorType}
        nameColorShade={page.bioNameColorShade}
        nameCustomColor={page.bioNameCustomColor}
        description={page.bioDescription}
        descriptionColor={page.bioDescriptionColor}
        backgroundColorType={page.bioBackgroundColorType}
        backgroundColorMode={page.bioBackgroundColorMode}
        backgroundColorShade={page.bioBackgroundColorShade}
        backgroundCustomColor={page.bioBackgroundCustomColor}
        backgroundGradient={page.bioBackgroundGradient}
        infoCards={page.infoCards}
      />
    )
  }

  {/* Global Perspective Section */}
  {
    (page.globalTitle || page.globalDescription) && (
      <AboutGlobal
        icon={page.globalIcon}
        iconColorType={page.globalIconColorType}
        iconColorShade={page.globalIconColorShade}
        iconCustomColor={page.globalIconCustomColor}
        title={page.globalTitle}
        titleColorType={page.globalTitleColorType}
        titleColorShade={page.globalTitleColorShade}
        titleCustomColor={page.globalTitleCustomColor}
        description={page.globalDescription}
        descriptionColor={page.globalDescriptionColor}
        backgroundColorType={page.globalBackgroundColorType}
        backgroundColorMode={page.globalBackgroundColorMode}
        backgroundColorShade={page.globalBackgroundColorShade}
        backgroundCustomColor={page.globalBackgroundCustomColor}
        backgroundGradient={page.globalBackgroundGradient}
      />
    )
  }

  {/* Trusted By Section */}
  {
    page.trustedByCaseStudies && page.trustedByCaseStudies.length > 0 && (
      <AboutTrustedBy
        title={page.trustedByTitle}
        showTitle={page.trustedByShowTitle}
        titleColorType={page.trustedByTitleColorType}
        titleColorShade={page.trustedByTitleColorShade}
        titleCustomColor={page.trustedByTitleCustomColor}
        caseStudies={page.trustedByCaseStudies}
        backgroundColorType={page.trustedByBackgroundColorType}
        backgroundColorMode={page.trustedByBackgroundColorMode}
        backgroundColorShade={page.trustedByBackgroundColorShade}
        backgroundCustomColor={page.trustedByBackgroundCustomColor}
        backgroundGradient={page.trustedByBackgroundGradient}
      />
    )
  }
</BaseLayout>
