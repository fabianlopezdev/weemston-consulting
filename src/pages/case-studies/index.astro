---
import BaseLayout from '@layouts/BaseLayout.astro';
import { client } from '@lib/sanity/client';
import { allCaseStudiesQuery } from '@lib/sanity/queries';
import { createTranslator } from '@lib/i18n/translations';
import Image from '@components/media/Image.astro';

const lang = Astro.locals.lang || 'en';
const t = createTranslator(lang);
const caseStudies = await client.fetch(allCaseStudiesQuery, { language: lang });
---

<BaseLayout title={t('seo.case_studies_title')}>
  <div class="container">
    <h1>{t('nav.case_studies')}</h1>
    <div class="case-studies-grid">
      {
        caseStudies.map((caseStudy) => (
          <article class="case-study-card">
            {caseStudy.mainImage && (
              <Image
                image={caseStudy.mainImage}
                alt={caseStudy.mainImage.alt}
                width={600}
                class="case-study-image"
              />
            )}
            <div class="case-study-content">
              {caseStudy.client && (
                <span class="client-name">{caseStudy.client}</span>
              )}
              <h2>
                <a href={`/case-studies/${caseStudy.slug.current}`}>
                  {caseStudy.title}
                </a>
              </h2>
              {caseStudy.industry && (
                <p class="industry">{caseStudy.industry}</p>
              )}
            </div>
          </article>
        ))
      }
    </div>
  </div>
</BaseLayout>

<style>
  .case-studies-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
    gap: var(--space-2xl);
    margin-block-start: var(--space-xl);
  }

  .case-study-card {
    border: var(--border-width-thin) solid var(--color-border);
    border-radius: var(--border-radius-md);
    overflow: hidden;
    transition: transform var(--transition-fast);
  }

  .case-study-card:hover {
    transform: translateY(-4px);
  }

  .case-study-content {
    padding: var(--space-lg);
  }

  .client-name {
    display: block;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    color: var(--color-primary);
    margin-block-end: var(--space-xs);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  h2 {
    margin-block-end: var(--space-sm);
  }

  .industry {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin-block-start: var(--space-xs);
  }
</style>
